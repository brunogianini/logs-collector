name: CI/CD

on:
  push:
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest
    continue-on-error: false
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Step 1 - Sucesso
        run: |
          echo "Buildando com sucesso..."

      - name: Step 2 - Falha
        id: build_fail
        continue-on-error: true
        run: |
          echo "Rodando step que vai falhar..."
          echo "Detalhe: falhou porque faltou dependÃªncia."
          exit 1

      - name: Step 3 - Outro step (ok)
        run: echo "Rodando step ok"

      - name: Logar steps que falharam
        if: failure() || steps.build_fail.outcome == 'failure'
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ§¾ LOG COMPLETO DOS STEPS QUE FALHARAM"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo
          
          # Exemplo simples: mostrar log do step build_fail (que falhou)
          echo "ğŸ“œ Step: build_fail"
          echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
          cat $GITHUB_WORKSPACE/$(basename $GITHUB_RUN_ID || echo "") 2>/dev/null || true

          # Ou, se preferir, apenas relogue uma mensagem clara:
          echo "ğŸ’¥ Step 'build_fail' falhou. Exibindo conteÃºdo simulado:"
          echo "Rodando step que vai falhar..."
          echo "Detalhe: falhou porque faltou dependÃªncia."
          echo "Exit code: 1"
          echo
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ Fim dos logs de falhas"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
