name: CI/CD

on:
  push:
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest
    continue-on-error: false
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Step 1 - Sucesso
        run: |
          echo "Buildando com sucesso..."

      - name: Step 2 - Falha
        id: build_fail
        continue-on-error: true
        run: |
          echo "Rodando step que vai falhar..."
          echo "Detalhe: falhou porque faltou dependência."
          exit 1

      - name: Step 3 - Outro step (ok)
        run: echo "Rodando step ok"

      - name: Logar steps que falharam
        if: failure() || steps.build_fail.outcome == 'failure'
        run: |
          echo "═══════════════════════════════════════════════"
          echo "🧾 LOG COMPLETO DOS STEPS QUE FALHARAM"
          echo "═══════════════════════════════════════════════"
          echo
          
          # Exemplo simples: mostrar log do step build_fail (que falhou)
          echo "📜 Step: build_fail"
          echo "───────────────────────────────────────────────"
          cat $GITHUB_WORKSPACE/$(basename $GITHUB_RUN_ID || echo "") 2>/dev/null || true

          # Ou, se preferir, apenas relogue uma mensagem clara:
          echo "💥 Step 'build_fail' falhou. Exibindo conteúdo simulado:"
          echo "Rodando step que vai falhar..."
          echo "Detalhe: falhou porque faltou dependência."
          echo "Exit code: 1"
          echo
          echo "═══════════════════════════════════════════════"
          echo "🏁 Fim dos logs de falhas"
          echo "═══════════════════════════════════════════════"
